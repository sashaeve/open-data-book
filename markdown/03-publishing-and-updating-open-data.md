# Публікація та оновлення відкритих даних

## Вибір формату даних та конвертація даних з одного формату в інший

Вибір формату даних залежить від способу збереження та інших факторів, проте в більшості випадків можна користуватись такими загальними правилами:

1. **Неструктуровані текстові дані** (тексти законів, розпоряджень, довідкових даних):  
    - Найкращий формат — Markdown або TXT.  
    - Markdown підтримує додаткову розмітку (заголовки, абзаци, посилання, зображення тощо).  
    - Вказуйте різновид Markdown.  
    - HTML — гірший варіант, doc/docx, pdf/tiff — найгірші (окрім випадків, коли потрібна копія оригінального документу із підписом та печаткою).
2. **Табличні дані:**  
    - Використовуйте формат CSV, у гіршому випадку — XLS/XLSX.
3. **Скани документів:**  
    - Найкращий формат — TIFF, потім — PDF.
4. **Зображення:**  
    - Обов'язкова роздільна здатність для OCR — не менше 300 dpi.
5. **Великі файли або групи файлів:**  
    - Архівуйте у форматі ZIP/7Z.  
    - Для файлів понад 4 ГБ — RAR.
6. **Дані, що змінюються постійно і формуються «на льоту»:**  
    - Не обов'язково зберігати у вигляді файлів.  
    - Достатньо надати доступ через Інтернет-адреси або API.  
    - Рекомендовані формати для API: JSON/XML/RDF.
7. **Бінарні формати:**  
    - Використовуйте лише за відсутності альтернативи.

Для конвертації даних існує багато інструментів: онлайн-сервіси, програмні засоби, бібліотеки. Зазвичай немає проблем з конвертацією між відкритими форматами. Проблеми можуть виникати з Word/PDF.

**Деякі програмні засоби для конвертації:**

- Microsoft Word, Excel, Access
- Графічні формати та PDF: Adobe Photoshop, Acrobat Reader, Foxit PDF Reader, Paint.NET, Corel Draw
- Текстові дані: Notepad++
- Програмні засоби: SPSS, Microsoft Azure ML, Matlab
- Онлайн інструменти:  
  - [JSON to CSV](http://konklone.io/json/)  
  - [CSV to JSON](http://www.convertcsv.com/csv-to-json.htm)  
  - [JSON to C#](http://json2csharp.com/)
- Очищення HTML документів від Word-стилів: [word2cleanhtml.com](https://word2cleanhtml.com/)

---

## Основні помилки при оприлюдненні відкритих даних

### Чому Excel формат не є рекомендованим форматом?

В Постанові дозволяється використовувати XLS/XLSX (Microsoft Excel). Проте Excel дозволяє додавати розширене форматування, об’єднані комірки, вбудовані об’єкти, макроси та формули, що ускладнює машинну обробку.

**Приклади неправильних Excel-документів:**

![Неправильний Excel 1](images/004.gif)  
![Неправильний Excel 2](images/005.gif)

**Приклади правильних Excel-файлів:**

![Правильний Excel 1](images/006.gif)  
![Правильний Excel 2](images/007.gif)

Дані у правильному форматі легко експортувати у CSV.

---

### Оприлюднення занадто агрегованих даних

**Очікується:**  
- ділянка та її координати  
- дата ДТП  
- кількість постраждалих та тип ушкоджень  
- область (місто)  
- стан ділянки

**Неправильно:**  
- лише кількість ДТП по областях

Розпорядники повинні публікувати детальну інформацію на рівні транзакцій, випадків або подій.

---

## Призначення відповідальних за розкриття даних

Кожен розпорядник повинен визначити відповідальних осіб за аудит, обробку та публікацію відкритих даних. Вони повинні знати про доступні набори, формати, розміри, роботу з базами даних та користуватись порталом відкритих даних.

---

## Аудит наборів відкритих даних і пріоритетність їх публікації

Публікація даних здійснюється поетапно, враховуючи:

1. Потребу споживачів (за методикою моніторингу)
2. Ступінь готовності (наявність даних, технічна готовність)
3. Витрати на публікацію та підтримку

**Фактори для формування реєстру:**

- Публікуються дані без попередньої обробки
- Визначена відповідальна особа за кожен набір
- Встановлена періодичність оновлення

Реєстр затверджується органом і публікується на офіційному сайті.

---

## Підготовка даних до публікації

### Кодування файлів

Текст зберігається у вигляді числових значень згідно стандарту кодування.

- **Windows-1251** — стандартне кодування для українських і російських версій Windows.  
  [Детальніше](https://uk.wikipedia.org/wiki/Windows-1251)
- **UTF-8** — універсальне кодування, сумісне з ASCII.  
  [Детальніше](https://uk.wikipedia.org/wiki/UTF-8)

Більшість державних органів використовують Windows-1251, що несумісне з іншими ОС. Перед публікацією на data.gov.ua переконайтесь, що файли збережені у UTF-8.

**Приклад проблем з кодуванням:**

![Проблеми з кодуванням](images/008.gif)

---

### Один файл чи декілька?

Якщо дані — реляційна база (MySQL, SQL Server, Oracle):

![Схема бази](images/009.gif)

**Приклад:**

*Vendors (виробники)*

| Id | Name      | Country | Website              |
|----|-----------|---------|----------------------|
| 1  | Microsoft | USA     | http://microsoft.com |
| 2  | Apple     | USA     | http://apple.com     |

*Models (моделі)*

| Id | Name    | Vendor Code |
|----|---------|-------------|
| 1  | Surface | 1           |
| 2  | iPhone  | 2           |

**Варіант 1: Один файл**

`models.csv`:

```csv
Id;Name;Vendor;Country;Website
1;Surface;Microsoft;USA;http://microsoft.com
2;iPhone;Apple;USA;http://apple.com
```

**Варіант 2: Два файли**

`vendors.csv`:

```csv
Id;Name;Country;Website
1;Microsoft;USA;http://microsoft.com
2;Apple;USA;http://apple.com
```

`models.csv`:

```csv
Id;Name;VendorId
1;Surface;1
2;iPhone;2
```

**Порівняння:**

| Критерій                           | Один файл                                                | Багато файлів                        |
|-------------------------------------|---------------------------------------------------------|--------------------------------------|
| Збитковість даних                   | Велика                                                  | Мала                                 |
| Фінальний розмір                    | Більший                                                 | Менший                               |
| Перевірка на цілісність             | Складна                                                 | Проста                               |
| Готовність до використання через API | Погана                                                  | Хороша                               |
| Кількість запитів                   | Один (перевага для малих файлів)                        | Багато                               |

Другий варіант доцільніший.

---

### Деперсоніфікація даних

Згідно [Закону “Про захист персональних даних”](http://zakon3.rada.gov.ua/laws/show/2297-17), персональні дані — будь-які відомості, за якими ідентифікується особа. Такі дані мають бути деперсоніфіковані перед публікацією.

**Приклад:**

*Початкові дані:*

| ПІП         | Місто | Телефон      | Група крові |
|-------------|-------|--------------|-------------|
| Іванов І.І. | Київ  | 011 111 11 11| A(I)+       |
| Петров П.П. | Одеса | 011 111 11 12| B(II)-      |

*Кроводачі:*

| ПІП         | Центр    | Дата       |
|-------------|----------|------------|
| Іванов І.І. | Охматдит | 01.01.2016 |
| Петров П.П. | Охматдит | 01.02.2016 |

*Після деперсоніфікації:*

| ПІП | Місто | Група крові |
|-----|-------|-------------|
| 1   | Київ  | A(I)+       |
| 2   | Одеса | B(II)-      |

*Кроводачі:*

| ПІП | Центр    | Дата       |
|-----|----------|------------|
| 1   | Охматдит | 01.01.2016 |
| 2   | Охматдит | 01.02.2016 |

---

### Архівація наборів даних

Архівація зменшує розмір файлів і трафік. Текстові дані стискаються до 90%, Word/Excel/PDF — на 10-60%, зображення — майже не стискаються.

**Архівувати потрібно:**

- історичні дані
- файли понад 50 МБ
- застарілі версії наборів
- багатотомні набори

**Рекомендовані формати:** zip/7z/tar.  
**Рекомендована програма:** [7-zip](http://7-zip.org.ua/)

---

### Публікація даних, що мають періодичність

Набори поділяються на:

- **Частопубліковані** (оновлення частіше 1 раз на тиждень)
- **Рідкопубліковані** (рідше 1 раз на тиждень)

В паспорті набору вказується дата останнього оновлення.

**Частота оновлень:**

- Часто: більше одного разу в день, щодня, щотижня
- Рідко: щомісяця, щокварталу, кожні півроку, щороку, по мірі змін

**Приклади іменування файлів:**

- За датою: `exchange_20160101.csv`
- За валютою: `exchange_usd.csv`

Якщо дані змінюються постійно — організуйте доступ через API.

---

### Публікація схожих даних з різними структурами

Якщо структура схожа — об'єднайте всі поля, відсутні дані залишайте порожніми.

**Приклад:**

```
A1,A2,A3,A4
1,1,1,1

A1,A2,A3,A5
2,2,2,2
```

**Фінальний файл:**

```
A1,A2,A3,A4,A5
1,1,1,1,
2,2,2,,2
```

Якщо структура відрізняється значно — розглядайте файли окремо.

---

### Публікація даних у вигляді API та робота з великими обсягами

Два основних способи доступу:

- **Data Hub** — для рідко змінюваних даних
- **API** — для оперативних запитів

Рекомендується використовувати [OData](http://www.odata.org/) для API.

В описі набору вказуйте тип даних, посилання на документацію, умови доступу, обмеження, формати, підтримку OData.

---

### Канали розповсюдження відкритих даних

1. Через сайт [data.gov.ua](https://data.gov.ua)
2. Через сайти місцевих органів самоврядування
3. За допомогою API
4. Через ftp-сервер
5. Через BitTorrent

